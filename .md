stateDiagram-v2
    %% Master FSM (Supervisor)
    state "Master FSM (Intersection Supervisor)" as Master {
        [*] --> NS_Phase
        
        state "North-South Active Phase" as NS_Phase {
            direction LR
            [*] --> NS_Slave : Enable NS Controller
            NS_Slave --> [*] : NS Done Signal
        }
        
        NS_Phase --> EW_Phase : Transition Trigger
        
        state "East-West Active Phase" as EW_Phase {
            direction LR
            [*] --> EW_Slave : Enable EW Controller
            EW_Slave --> [*] : EW Done Signal
        }
        
        EW_Phase --> NS_Phase : Transition Trigger
    }

    %% Slave FSM Detayları (Dışarıda tanımlanmış yerel mantık)
    state "Slave FSM (Directional Controller)" as SlaveDetail {
        direction TB
        Green --> Yellow
        Yellow --> Red
        Red --> Done
    }

    note right of Master : Supervisor sadece fazları yönetir,\nışıkları tek tek kontrol etmez.
    note left of SlaveDetail : Her yön (N, S, E, W) bu\nyerel diziyi çalıştırır.